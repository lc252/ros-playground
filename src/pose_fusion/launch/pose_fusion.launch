<launch>

    <!-- EKF Node -->
    <node pkg="robot_localization" type="ekf_localization_node" name="robot_localization_ekf_node" clear_params="true">
        <rosparam command="load" file="$(find pose_fusion)/params/pose_inputs.yaml"/>
    </node>

    <!-- Fake Sensors -->
    <node pkg="pose_fusion" type="fake_aruco.py" name="fake_aruco"/>
    <node pkg="pose_fusion" type="fake_imu.py" name="fake_imu"/>

    <!-- Transform message conversion -->
    <node pkg="pose_fusion" type="aruco_msg_to_pose.py" name="converter"/>

    <!-- Fake TF nodes to link sensor frames -->
    <node pkg="tf" name="link_to_optical" type="static_transform_publisher"
        args="0 0 0 0 0 0 camera_link camera_color_optical_frame 1">
    </node>
    <node pkg="tf" name="link_to_imu" type="static_transform_publisher"
        args="0 0 0 0 0 0 camera_link imu_frame 1">
    </node>

    <!-- Fake TF nodes to simulate linked rigid body -->
    <node pkg="tf" name="base_to_1" type="static_transform_publisher"
        args="0 0 0.5 0 0 0 base_link link_1 1">
    </node>
    <node pkg="tf" name="link_1_2" type="static_transform_publisher"
        args="0.5 0 0 0 0 0 link_1 link_2 1">
    </node>
    <node pkg="tf" name="link_2_3" type="static_transform_publisher"
        args="0 0 0.5 0 0 0 link_2 link_3 1">
    </node>

    <!-- Transform from arucos to rigid body -->
    <!-- <node pkg="tf" name="ar_1" type="static_transform_publisher"
        args="0 0 0 0 0 0 aruco_1 base_link 1">
    </node>    
    <node pkg="tf" name="ar_2" type="static_transform_publisher"
        args="0 0 0 0 0 0 aruco_2 base_link 1">
    </node>    
    <node pkg="tf" name="ar_3" type="static_transform_publisher"
        args="0 0 0 0 0 0 aruco_3 base_link 1">
    </node>    
    <node pkg="tf" name="ar_4" type="static_transform_publisher"
        args="0 0 0 0 0 0 aruco_4 base_link 1">
    </node> -->

    <!-- Visualisation -->
    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find pose_fusion)/rviz/settings.rviz" required="true"/>
    <node pkg="rqt_tf_tree" type="rqt_tf_tree" name="rqt_tf_tree"/>

</launch>